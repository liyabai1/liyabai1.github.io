<!DOCTYPE html>
<html lang="zh-en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday</title>
    <style>
        *{
            margin: 0px;
            padding: 0px;
        }
        body{
            position: relative;
        }
        ul{
            list-style: none;
            display: block;
            margin: auto;
            position: relative;
        }
        li{
            position: absolute;
            /* background-color: royalblue; */
            background-size: 100% 100%;
        }
        .main{
            width: 600px;
            margin: auto;
            
            /* background-color: rgb(121, 112, 112); */
            margin-top: 10px;
        }
        .main .bgimg{
            display: block;
            margin: auto;
        }
        .cakeBox{
            animation: zhuan 10s linear infinite;
            transform-style: preserve-3d;
        }
        @keyframes zhuan {
            from {transform: rotateX(-20deg) rotateY(0deg) ;}
            to {transform: rotateX(-20deg) rotateY(360deg) ;}
        }
        @-webkit-keyframes zhuan{
            from {transform: rotateX(-20deg) rotateY(0deg);}
            to {transform: rotateX(-20deg) rotateY(360deg);}
        }
        .barrage{
            position: fixed;
        }
        .barrage p{
            z-index: 99;
            display: inline-block;
            min-width: 300px;
            position: fixed;
            top: 0px;
            /* animation: ma 10s infinite linear; */
            /* animation-duration: 10s; */
            animation-timing-function: linear;
            animation-iteration-count: infinite;
            left: -400px;
        }
        @keyframes ma {
            from{ left: -400px; }
            to{left: 100%;}
        }
        .playBtn{
            position: fixed;
            top: 20px;
            right: 20px;
        }
    </style>
</head>
<body>
    <div class="main">
        <img class="bgimg" src="HBbgimg.png" alt="" height="100px" width="300px">
        <div class="cakeBox">

        </div>
    </div>
    <div class="barrage">
        <p>ç¥ä½ 22å²å¿«ä¹</p>
        <p>ç ´å£³å¿«ä¹ğŸ‚</p>
        <p>è¦åŠªåŠ›ï¼Œè¦é…·</p>
        <p>M78æ˜Ÿäº‘å…¨ä½“å¥¥ç‰¹æ›¼ç¥ä½ ç”Ÿæ—¥å¿«ä¹</p>
        <p>å¹¿å·å½­äºæ™å‘æ¥ç¥ç¦âœ‰ï¸</p>
        <p>å°æ–°æ²¡æœ‰èœ¡ç¬”å‘æ¥ç¥ç¦ï¼šHappy Birthday</p>
    </div>
    <div class="playBtn">
        <input type="button" value="æ’­æ”¾éŸ³ä¹" onclick="playMusic()">
    </div>
</body>
<script>

// ç»™è›‹ç³•æ•´ä½“åˆ›å»ºæ¯ä¸€å±‚ => ul
var cakeBox = document.getElementsByClassName("cakeBox")

/** 
 * åˆ›å»ºæ¯ä¸€å±‚çš„è›‹ç³• => ulæ ‡ç­¾
 * ulå†…éƒ¨ç”±numä¸ªliæ ‡ç­¾ç»„æˆï¼Œé€çº§é€’å¢
 */
function creatPerFloorCake (num) {
    // é¦–å…ˆforå¾ªç¯åˆ›å»ºulæ ‡ç­¾
    // å†…éƒ¨åœ¨ä½¿ç”¨forå¾ªç¯åˆ›å»ºliæ ‡ç­¾
    for (let i = 0; i < num; i++ ) {

        let UL = document.createElement("ul")

        for (let j = 0; j < (i+1) * 4; j++) {

            let LI = document.createElement("li")

            LI.setAttribute("li-index",j)

            //å®šä¹‰æ¯ä¸€å±‚çš„é•¿å®½ï¼Œåˆå§‹å€¼ä¸ºå®½80,é•¿120 åé¢ä¾æ¬¡é€å±‚é€’åŠ 20
            LI.style.width = `${60 + i * 20}px`
            LI.style.height = `${90 + i * 20}px`
            
            //å®šä¹‰æ¯ä¸€ä¸ªliçš„å˜æ¢æ–¹å¼
            LI.style.transform = `rotateY(${360/((i+1) * 4) * j}deg) translateZ(${50 + i * 50}px)`    //ä¾æ®æ¯ä¸€å±‚çš„ä¸ªæ•°ï¼Œè®¡ç®—æ—‹è½¬è§’åº¦

            // æ¯5ä¸ªä¸€è½®å›èƒŒæ™¯å›¾
            switch ( i % 5 ){
                case 0:
                    LI.style.backgroundImage = `url(caomei.png)`
                    break;
                case 1:
                    LI.style.backgroundImage = `url(boluo.png)`
                    break;
                case 2:
                    LI.style.backgroundImage = `url(yingtao.png)`
                    break;
                case 3:
                    LI.style.backgroundImage = `url(xigua.png)`
                    break;
                case 4:
                    LI.style.backgroundImage = `url(juzi.png)`
                    break;
                
            }

            UL.appendChild(LI);
        }

        //åˆ›å»ºæ¯å±‚è›‹ç³•çš„é¡¶éƒ¨å°ç›–
        var cover = document.createElement("li")
        cover.style.width = `${(50 + i * 50) * 2}px`;
        cover.style.height = `${(50 + i * 50) * 2}px`;
        cover.style.borderRadius = `50%`;
        cover.style.backgroundColor = "#fff";
        cover.style.transform = `rotateX(90deg) translateZ(${50 + i * 50}px) translateX(${-(20 + i * 40)}px) `
        UL.appendChild(cover)
        
        UL.setAttribute("ul-index",i)
        UL.style.width = `${80 + i * 20}px`
        UL.style.height = `${90 + i * 20}px`
        cakeBox[0].appendChild(UL)
    }
}


var AUDIO = new Audio()
    AUDIO.autoplay = true;
new Promise(function(resolve){
    // åˆ¤æ–­ç”¨æˆ·éœ€è¦è¾“å…¥çš„è›‹ç³•å±‚æ•°
    var input = window.prompt("è¯·é—®ä½ æƒ³è¦å¤šå¤§çš„è›‹ç³•ï¼Ÿä¸å»ºè®®å¤§äº10", "5")
    if (!input) {
        alert("è¯·è¾“å…¥æ•°å­—å“¦ã€‚")
        location.reload()
    } else {
        
        AUDIO.src = "https://music.163.com/song/media/outer/url?id=41648129.mp3"
        
        AUDIO.loop = true;
        AUDIO.play()

        resolve(input)  
    }
}).then(function (input) {
    
    var inputNum = Number(input.trim());
    inputNum > 10 ? 10 : inputNum
    if (typeof inputNum == "number" && !isNaN(inputNum)) {
    console.log("æ‰§è¡Œ")
    creatPerFloorCake(inputNum)

    document.querySelector("body").style.backgroundColor = "#FFC0CB"
    
    } else {
        alert("è¯·è¾“å…¥æ•°å­—å“¦ã€‚")
        location.reload()
    }

})


    // // åˆ¤æ–­ç”¨æˆ·éœ€è¦è¾“å…¥çš„è›‹ç³•å±‚æ•°
    // var input = window.prompt("è¯·é—®ä½ æƒ³è¦å¤šå¤§çš„è›‹ç³•ï¼Ÿä¸å»ºè®®å¤§äº10", "5")
    
    // if (!input) {
    //     alert("è¯·è¾“å…¥æ•°å­—å“¦ã€‚")
    //     location.reload()
    // } else {


    //     // const AUDIO = new Audio()
    //     // AUDIO.src = "https://music.163.com/song/media/outer/url?id=41648129.mp3"
    //     // AUDIO.autoplay = true;
    //     // AUDIO.loop = true;
    //     // console.log(AUDIO)
    //     var inputNum = Number(input.trim());
    //     inputNum > 10 ? 10 : inputNum
    //     if (typeof inputNum == "number" && !isNaN(inputNum)) {
    //     console.log("æ‰§è¡Œ")
    //     creatPerFloorCake(inputNum)

    //     document.querySelector("body").style.backgroundColor = "#FFC0CB"
        
    //     } else {
    //         alert("è¯·è¾“å…¥æ•°å­—å“¦ã€‚")
    //         location.reload()
    //     }
    // } 


//æ–‡å­—è·‘é©¬ç¯æ•ˆæœ
function ma() {
    var textArr = document.getElementsByClassName("barrage");
        textArr = document.querySelectorAll("p")
        console.log(textArr)
    textArr.forEach(item => {
        item.style.top = `${Math.random()*300 + 5}px`
        item.style.animationName = 'ma'
        item.style.animationDelay = `${Math.random() * 5 + 1}s`
        item.style.animationDuration = `${Math.random() * 10 + 10}s`
    });
}
ma()
const audio = new Audio()
audio.autoplay = true
function playMusic() {
    audio.src = "https://music.163.com/song/media/outer/url?id=41648129.mp3"
}
</script>
</html>